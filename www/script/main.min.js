"use strict";async function preload(){let a=await request();render(a),main(a)}async function request(){let a;try{a=checkConnection()?await getValutesOnline():getCache()}catch(b){showNetErr(b)}return a}async function getValutesOnline(){try{let a=await getAndParseJSON("http://api.fixer.io/latest");return configObj(a),writeFile(a),a}catch(a){showNetErr(a)}}async function getAndParseJSON(a){let b=await fetch(a),c=await b.json();return c}function showNetErr(a){console.error(a),swal(swalOptions).then(function(){preload()},swalCallback)}function configObj(a){if(a.rates[a.base]=1,console.log(a),!a)throw new Error("Can`t get data")}function checkConnection(){return window.navigator.onLine}function getCache(){return readFile()||showCacheErr()}function render(a){class b extends React.Component{render(){let c=this.props.data,d=[];for(let f in c.rates)d.push(React.createElement("li",{className:"mdc-list-item",role:"option",tabindex:"0"},f));return React.createElement("ul",{className:"mdc-list mdc-simple-menu__items"},d)}}ReactDOM.render(React.createElement(b,{data:a}),document.getElementById("list-from-wrapper")),ReactDOM.render(React.createElement(b,{data:a}),document.getElementById("list-to-wrapper"))}let swalOptions={title:"Oops...",html:"Problem with your internet connection!<br>Sorry, our app need internet.",type:"error",showCloseButton:!0,showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Retry",cancelButtonText:"Exit"},swalCallback=function(a){"cancel"===a?navigator.app.exitApp():"close"==a&&preload()};function main(a){mdc.autoInit();let b=new mdc.drawer.MDCTemporaryDrawer(document.querySelector(".mdc-temporary-drawer"));document.querySelectorAll(".menu").forEach(o=>o.addEventListener("click",()=>b.open=!0));const c=new mdc.select.MDCSelect(document.querySelectorAll(".mdc-select")[0]),d=new mdc.select.MDCSelect(document.querySelectorAll(".mdc-select")[1]),f=new mdc.textfield.MDCTextfield(document.querySelectorAll(".mdc-textfield")[0]),g=new mdc.textfield.MDCTextfield(document.querySelectorAll(".mdc-textfield")[1]),h=document.querySelector("#changer"),i=document.querySelectorAll(".page__main, .page__settings, .page__about"),j=Array.prototype.slice.call(document.querySelector(".mdc-temporary-drawer__content").children),k=new mdc.snackbar.MDCSnackbar(document.querySelector(".mdc-snackbar")),l=document.querySelector(".page__loading"),m=document.querySelector(".page__main");document.querySelectorAll(".mdc-temporary-drawer__content > .mdc-list-item").forEach(o=>o.addEventListener("click",function(){openWindow(this,b,i,j)}));let n;c.listen("MDCSelect:change",()=>{calc(a,c,d,f,g)}),d.listen("MDCSelect:change",()=>{calc(a,c,d,f,g)}),h.onclick=()=>{swapHandler(a,c,d,f,g)},setInterval(checker,10,a,c,d,f,g,n),setTimeout(()=>{l.classList.add("off"),m.style.display="block"},20)}function openWindow(a,b,c,d){let f=a.dataset.window;c.forEach(g=>g.style.display="none"),document.querySelector(f).style.display="block",d.forEach(g=>g.classList.remove("mdc-temporary-drawer--selected")),a.classList.add("mdc-temporary-drawer--selected"),b.open=!1}function calc(a,b,c,d,f){const[g,h,i]=countValCoefRes(a,d,b,c);return""===i?void removeVal(f):void writeVal(h/g,f)}function countValCoefRes(a,b,c,d){const f=c.selectedText_.textContent,g=d.selectedText_.textContent,h=a.rates[f],i=a.rates[g],k=b.input_.value,l=parseFloat(k);return[h/i,l,k]}function writeVal(a,b){a=a?a:0,b.label_.classList.add("mdc-textfield__label--float-above"),b.input_.value=a}function removeVal(a){a.label_.classList.remove("mdc-textfield__label--float-above"),a.input_.value=""}function checker(a,b,c,d,f,g){let h=d.input_.value;h!=g&&a.rates&&calc(a,b,c,d,f),g=h}function swapHandler(a,b,c,d,f){let g=b.selectedText_.textContent,h=c.selectedText_.textContent;b.selectedText_.textContent=h,c.selectedText_.textContent=g,calc(a,b,c,d,f)}function writeRequestFS(a){a.root.getFile("cache.json",{create:!0},writeFileEntry,errorCallback)}function writeFileEntry(a){a.createWriter(writeFileWriter,errorCallback)}function writeFileWriter(a){a.onwriteend=onwriteend,a.onerror=onwriteerror;let b=new Blob([JSON.stringify(data)],{type:"application/json"});a.write(b)}function onwriteend(){console.log("Write completed.")}function onwriteerror(a){throw new Error("Write failed: "+a.toString())}function writeFile(){let b=window.TEMPORARY;window.requestFileSystem(b,5242880,writeRequestFS,function(d){throw new Error("Write error: "+d.code)})}function readFile(){let b=window.TEMPORARY;window.requestFileSystem(b,5242880,successCallback,function(d){throw new Error("Read error: "+d.code)})}function readRequestFS(a){a.root.getFile("cache.json",{},readFileEntry,errorCallback)}function readFileEntry(a){a.file(function(b){let c=new FileReader;c.onloadend=function(){data=JSON.parse(this.result),snackbarOpt.message=`Using rates from ${data.date}`,snackbar.show(snackbarOpt)},c.readAsText(b)},errorCallback)}document.addEventListener("deviceready",preload,!1);