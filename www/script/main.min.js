'use strict';const input1=document.querySelector('#input1'),input2=document.querySelector('#input2'),selectFrom=document.querySelector('#select1'),selectTo=document.querySelector('#select2'),content=document.querySelector('.content'),spinner=document.querySelector('.spinner'),main=document.querySelector('.main'),submit=document.querySelector('.submit');let data={},swalOptions={title:'Oops...',html:'Problem with your internet connection!<br>Sorry, our app need internet.',type:'error',showCloseButton:!0,showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:'Retry',cancelButtonText:'Exit'},swalCallback=function(a){'cancel'===a?navigator.app.exitApp():'close'==a&&work()};submit.onclick=clickHandler,document.addEventListener('deviceready',work,!1);async function getValutesOnline(){try{data=await getAndParseJSON('http://api.fixer.io/latest'),configObj(data),writeFile()}catch(a){showNetErr(a)}}function configObj(a){if(a.rates[a.base]=1,console.log(a),!a)throw new Error('Can`t get data')}async function getAndParseJSON(a){let b=await fetch(a),c=await b.json();return c}function getValutesOffline(){readFile()}function checkConnection(){return window.navigator.onLine}function showNetErr(a){console.error(a),swal(swalOptions).then(function(){work()},swalCallback)}function work(){try{checkConnection()?getValutesOnline():getValutesOffline(),enableMain()}catch(a){showNetErr(a)}spinner.classList.add('off')}function enableMain(){main.classList.add('active'),content.classList.add('active')}function clickHandler(){const a=selectFrom.value,b=selectTo.value,c=data.rates[a],d=data.rates[b],f=c/d,g=parseFloat(input1.value);!isNaN(g)&&f&&(input2.parentElement.classList.add('is-dirty'),input2.value=g*f||0)}function showCacheErr(a){console.error(a)}function writeFile(){function b(f){throw new Error('Write error: '+f.code)}let c=window.TEMPORARY;window.requestFileSystem(c,5242880,function(f){f.root.getFile('cache.json',{create:!0},function(g){g.createWriter(function(h){h.onwriteend=function(){throw new Error('Write completed.')},h.onerror=function(j){throw new Error('Write failed: '+j.toString())};let i=new Blob([JSON.stringify(data)],{type:'application/json'});h.write(i)},b)},b)},b)}function readFile(){function b(f){throw new Error('Read error: '+f.code)}let c=window.TEMPORARY;window.requestFileSystem(c,5242880,function(f){f.root.getFile('cache.json',{},function(g){g.file(function(h){let i=new FileReader;i.onloadend=function(){data=JSON.parse(this.result)},i.readAsText(h)},b)},b)},b)}